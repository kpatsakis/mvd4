static CVE_2011_4101_PATCHED_dissect_infiniband_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, gboolean starts_with_grh) gint offset = 0 ; if ( ! dst_addr )  dst_addr = ep_alloc ( ADDR_MAX_LEN ); if ( tree && tree -> parent )  tree = tree -> parent; if ( 0 && ! tree )  if ( starts_with_grh )  lnh_val = IBA_GLOBAL; offset += 1; lnh_val = tvb_get_guint8 ( tvb , offset ); lnh_val = lnh_val & 0x03; offset += 1; * ( ( guint16 * ) dst_addr ) = tvb_get_ntohs ( tvb , offset ); switch ( lnh_val )  memcpy ( dst_addr , & DSTgid , GID_SIZE ); SET_ADDRESS ( & pinfo -> dst , AT_IB , GID_SIZE , dst_addr ); g_snprintf ( dst_addr , ADDR_MAX_LEN , "IPv6 over IB Packet" ); SET_ADDRESS ( & pinfo -> dst , AT_STRINGZ , ( int ) strlen ( dst_addr ) + 1 , dst_addr ); 