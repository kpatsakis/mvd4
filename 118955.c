static gboolean logcat_seek_read(wtap *wth, gint64 struct wtap_pkthdr *phdr, Buffer int *err, gchar **err_info) if ( file_seek ( wth -> random_fh , seek_off , SEEK_SET , err ) == - 1 )  if ( ! logcat_read_packet ( ( struct logcat_phdr * ) wth -> priv , wth -> random_fh , phdr , buf , err , err_info ) )  static gboolean logcat_read_packet(struct logcat_phdr *logcat, FILE_T struct wtap_pkthdr *phdr, Buffer *buf, int *err, gchar **err_info) gint bytes_read ; guint tmp [ 2 ] ; guint8 * pd ; bytes_read = file_read ( & tmp , 2 , fh ); if ( bytes_read != 2 )  if ( logcat -> version == 1 )  if ( logcat -> version == 2 )  pd = buffer_start_ptr ( buf ); memcpy ( pd , tmp , 2 ); bytes_read = file_read ( pd + 2 , packet_size - 2 , fh ); if ( bytes_read != packet_size - 2 )  phdr -> ts . secs = ( time_t ) pletoh32 ( pd + 12 ); phdr -> ts . nsecs = ( int ) pletoh32 ( pd + 16 ); phdr -> caplen = packet_size; phdr -> len = packet_size; phdr -> pseudo_header . logcat . version = logcat -> version; 