static int CVE_2013_4264_VULN_kempf_decode_tile(G2MContext *c, int tile_x, int const uint8_t *src, int src_size) uint8_t pal [ 768 ] , transp [ 3 ] ; int sub_type ; if ( src_size < 2 )  hdr = * src ++; sub_type = hdr >> 5; if ( sub_type == 0 )  if ( sub_type == 1 )  if ( sub_type != 2 )  src += 3; npal = * src ++ + 1; memcpy ( pal , src , npal * 3 ); if ( ! memcmp ( pal + i * 3 , transp , 3 ) )  kempf_restore_buf ( c -> kempf_buf , dlen , dst , c -> framebuf_stride , NULL , 0 , width , height , pal , npal , tidx ); kempf_restore_buf ( c -> kempf_buf , dlen , dst , c -> framebuf_stride , c -> jpeg_tile , c -> tile_stride , width , height , pal , npal , tidx ); 