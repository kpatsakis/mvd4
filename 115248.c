static int megasas_dcmd_pd_get_list(MegasasState *s, MegasasCmd *cmd) struct mfi_pd_list info ; size_t dcmd_size = sizeof ( info ) ; memset ( & info , 0 , dcmd_size ); info . addr [ num_pd_disks ] . device_id = cpu_to_le16 ( pd_id ); info . addr [ num_pd_disks ] . encl_device_id = 0xFFFF; info . addr [ num_pd_disks ] . encl_index = 0; info . addr [ num_pd_disks ] . slot_number = sdev -> id & 0xFF; info . addr [ num_pd_disks ] . scsi_dev_type = sdev -> type; info . addr [ num_pd_disks ] . connect_port_bitmap = 0x1; info . addr [ num_pd_disks ] . sas_addr [ 0 ] = cpu_to_le64 ( megasas_get_sata_addr ( pd_id ) ); static uint64_t megasas_get_sata_addr(uint16_t id) return addr & ( id << 24 ) ; num_pd_disks ++; trace_megasas_dcmd_pd_get_list ( cmd -> index , num_pd_disks , max_pd_disks , offset ); info . size = cpu_to_le32 ( offset ); info . count = cpu_to_le32 ( num_pd_disks ); cmd -> iov_size -= dma_buf_read ( ( uint8_t * ) & info , offset , & cmd -> qsg ); 