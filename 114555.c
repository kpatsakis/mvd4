static int32_t scsi_invalid_command(SCSIRequest *req, uint8_t *buf) scsi_req_build_sense ( req , SENSE_CODE ( INVALID_OPCODE ) ); void scsi_req_build_sense(SCSIRequest *req, SCSISense sense) memset ( req -> sense , 0 , 18 ); req -> sense [ 0 ] = 0x70; req -> sense [ 2 ] = sense . key; req -> sense [ 7 ] = 10; req -> sense [ 12 ] = sense . asc; req -> sense [ 13 ] = sense . ascq; req -> sense_len = 18; 