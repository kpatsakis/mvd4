 nsPrimitiveHelpers :: CreatePrimitiveForData ( const char* aFlavor, const void* uint32_t aDataLen, nsISupports** aPrimitive ) if ( ! aPrimitive )  if ( strcmp ( aFlavor , kTextMime ) == 0 || strcmp ( aFlavor , kNativeHTMLMime ) == 0 )  nsCOMPtr < nsISupportsString > primitive = do_CreateInstance ( NS_SUPPORTS_STRING_CONTRACTID ) ; if ( primitive )  if ( aDataLen % 2 )  nsAutoArrayPtr < char > buffer ( new char [ aDataLen + 1 ] ) ; if ( ! MOZ_LIKELY ( buffer ) )  memcpy ( buffer , aDataBuff , aDataLen ); buffer [ aDataLen ] = 0; const char16_t * start = reinterpret_cast < const char16_t * > buffer . get ( ) primitive -> SetData ( Substring ( start , start + ( aDataLen + 1 ) / 2 ) ); const char16_t * start = reinterpret_cast < const char16_t * > aDataBuff primitive -> SetData ( Substring ( start , start + ( aDataLen / 2 ) ) ); 