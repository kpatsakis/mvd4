static void CVE_2013_2852_VULN_b43_request_firmware(struct work_struct *work) struct b43_wl * wl = container_of ( work struct b43_wl , firmware_load ) struct b43_wldev * dev = wl -> current_dev ; struct b43_request_fw_context * ctx ; unsigned int i ; int err ; const char * errmsg ; ctx = kzalloc ( sizeof ( * ctx ) , GFP_KERNEL ); if ( ! ctx )  ctx -> dev = dev; ctx -> req_type = B43_FWTYPE_PROPRIETARY; err = b43_try_request_fw ( ctx ); if ( ! err )  if ( ctx -> fatal_failure )  ctx -> req_type = B43_FWTYPE_OPENSOURCE; err = b43_try_request_fw ( ctx ); if ( ! err )  if ( ctx -> fatal_failure )  for (i = 0; i < B43_NR_FWTYPES; i++) errmsg = ctx -> errors [ i ]; if ( strlen ( errmsg ) )  