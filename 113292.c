nsresult nsZipArchive::BuildSynthetics() if ( mBuiltSynthetics )  for (int i = 0; i < ZIP_TABSIZE; ++i) for (nsZipItem* item = mFiles[i]; item != nullptr; item = item->next) if ( item -> isSynthetic )  uint16_t namelen = item -> nameLength ; const char * name = item -> Name ( ) ; for (uint16_t dirlen = namelen - 1; dirlen > 0; dirlen--) if ( name [ dirlen - 1 ] != '/' )  if ( name [ dirlen ] == '/' )  uint32_t hash = HashName ( item -> Name ( ) , dirlen ) ; static uint32_t HashName(const char* aName, uint16_t len) const uint8_t * p = ( const uint8_t * ) aName ; const uint8_t * endp = p + len ; uint32_t val = 0 ; while ( p != endp )  val = val * 37 + * p ++; return ( val % ZIP_TABSIZE ) ; bool found = false ; for (nsZipItem* zi = mFiles[hash]; zi != nullptr; zi = zi->next) if ( ( dirlen == zi -> nameLength ) && ( 0 == memcmp ( item -> Name ( ) , zi -> Name ( ) , dirlen ) ) )  found = true; if ( found )  nsZipItem * diritem = CreateZipItem ( ) ; if ( ! diritem )  diritem -> central = item -> central; diritem -> nameLength = dirlen; diritem -> isSynthetic = true; diritem -> next = mFiles [ hash ]; mFiles [ hash ] = diritem; 