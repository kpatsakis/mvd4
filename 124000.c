int ff_alloc_packet(AVPacket *avpkt, int size) return ff_alloc_packet2 ( NULL , avpkt , size , 0 ) ; int ff_alloc_packet2(AVCodecContext *avctx, AVPacket *avpkt, int64_t size, int64_t min_size) if ( avpkt -> size < 0 )  if ( size < 0 || size > INT_MAX - AV_INPUT_BUFFER_PADDING_SIZE )  if ( avctx && 2 * min_size < size )  if ( ! avpkt -> data || avpkt -> size < size )  av_fast_padded_malloc ( & avctx -> internal -> byte_buffer , & avctx -> internal -> byte_buffer_size , size ); void av_fast_padded_malloc(void *ptr, unsigned int *size, size_t min_size) uint8_t * * p = ptr ; if ( min_size > SIZE_MAX - AV_INPUT_BUFFER_PADDING_SIZE )  if ( ! ff_fast_malloc ( p , size , min_size + AV_INPUT_BUFFER_PADDING_SIZE , 1 ) )  memset ( * p + min_size , 0 , AV_INPUT_BUFFER_PADDING_SIZE ); 