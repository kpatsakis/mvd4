static struct sk_buff *CVE_2011_4326_VULN_udp6_ufo_fragment(struct sk_buff *skb, int features) unsigned int mss ; unsigned int unfrag_ip6hlen , unfrag_len ; u8 * mac_start , * prevhdr ; u8 frag_hdr_sz = sizeof ( struct frag_hdr ) ; int offset ; __wsum csum ; mss = skb_shinfo ( skb ) -> gso_size; if ( unlikely ( skb -> len <= mss ) )  if ( skb_gso_ok ( skb , features | NETIF_F_GSO_ROBUST ) )  offset = skb -> csum_start - skb_headroom ( skb ); csum = skb_checksum ( skb , offset , skb -> len - offset , 0 ); offset += skb -> csum_offset; * ( __sum16 * ) ( skb -> data + offset ) = csum_fold ( csum ); skb -> ip_summed = CHECKSUM_NONE; if ( ( skb_headroom ( skb ) < frag_hdr_sz ) && pskb_expand_head ( skb , frag_hdr_sz , 0 , GFP_ATOMIC ) )  unfrag_ip6hlen = ip6_find_1stfragopt ( skb , & prevhdr ); unfrag_len = skb_network_header ( skb ) - skb_mac_header ( skb ) + unfrag_ip6hlen; mac_start = skb_mac_header ( skb ); memmove ( mac_start - frag_hdr_sz , mac_start , unfrag_len ); 