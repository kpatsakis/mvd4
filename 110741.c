static void ide_data_writel(void *opaque, uint32_t addr, uint32_t val) IDEState * s = ( ( IDEState * ) opaque ) -> cur_drive ; if ( ! ( s -> status & DRQ_STAT ) )  buffered_pio_write ( s , addr , 4 ); static inline buffered_pio_write(IDEState *s, uint32_t addr, int size) struct pio_buffer * piobuf = piobuf_by_addr ( addr ) ; static inline struct pio_buffer piobuf_by_addr(uint32_t addr) if ( addr == 0x1F0 )  return & buffered_pio_page -> pio [ PIO_BUFFER_IDE_PRIMARY ] ; if ( addr == 0x170 )  return & buffered_pio_page -> pio [ PIO_BUFFER_IDE_SECONDARY ] ; return NULL ; if ( ! piobuf )  buffered_pio_flush ( piobuf ); static inline buffered_pio_flush(struct pio_buffer *piobuf) IDEState * s = piobuf -> opaque ; uint32_t pointer = piobuf -> pointer ; if ( s != NULL && pointer > 0 )  __buffered_pio_flush ( piobuf , s , pointer ); static inline __buffered_pio_flush(struct pio_buffer *piobuf, IDEState *s, uint32_t pointer) uint8_t * buf = ( uint8_t * ) buffered_pio_page + piobuf -> page_offset ; memcpy ( s -> data_ptr , buf , pointer ); s -> data_ptr += pointer; 