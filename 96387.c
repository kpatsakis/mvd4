static long hiddev_compat_ioctl(struct file *file, unsigned int cmd, unsigned long arg) return hiddev_ioctl ( file , cmd , ( unsigned long ) compat_ptr ( arg ) ) ; static long hiddev_ioctl(struct file *file, unsigned int cmd, unsigned long arg) struct hiddev_list * list = file -> private_data ; struct hiddev * hiddev = list -> hiddev ; struct hiddev_devinfo dinfo ; if ( ! hiddev -> exist )  switch ( cmd )  memset ( & dinfo , 0 , sizeof ( dinfo ) ); dinfo . bustype = BUS_USB; dinfo . busnum = dev -> bus -> busnum; dinfo . devnum = dev -> devnum; dinfo . ifnum = usbhid -> ifnum; dinfo . vendor = le16_to_cpu ( dev -> descriptor . idVendor ); dinfo . product = le16_to_cpu ( dev -> descriptor . idProduct ); dinfo . version = le16_to_cpu ( dev -> descriptor . bcdDevice ); dinfo . num_applications = hid -> maxapplication; r = copy_to_user ( user_arg , & dinfo , sizeof ( dinfo ) ) ? - EFAULT : 0; return r ; 