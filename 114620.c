static int CVE_2013_5641_PATCHED_handle_incoming(struct sip_pvt *p, struct sip_request *req, struct ast_sockaddr *addr, int *recount, int *nounlock) const char * cmd ; const char * cseq ; const char * via ; uint32_t seqno ; int len ; int error = 0 ; cseq = sip_get_header ( req , "Cseq" ); cmd = REQ_OFFSET_TO_STR ( req , header [ 0 ] ); via = __get_header ( req , "Via" , & via_pos ); if ( ast_strlen_zero ( cmd ) || ast_strlen_zero ( cseq ) || ast_strlen_zero ( via ) )  error = 1; if ( ! error && sscanf ( cseq , "%30u%n" , & seqno , & len ) != 1 )  error = 1; if ( error )  if ( req -> method == SIP_RESPONSE )  p -> method = req -> method; if ( p -> icseq && ( p -> icseq > seqno ) )  if ( p -> pendinginvite && seqno == p -> pendinginvite && ( req -> method == SIP_ACK || req -> method == SIP_CANCEL ) )  if ( req -> method == SIP_INVITE )  unsigned int ran = ( ast_random ( ) % 10 ) + 1 ; char seconds [ 4 ] ; snprintf ( seconds , sizeof ( seconds ) , "%u" , ran ); transmit_response_with_retry_after ( p , "500 Server error" , req , seconds ); 