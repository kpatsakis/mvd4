static ssize_t unix_stream_splice_read(struct socket *sock,  loff_t struct pipe_inode_info size_t size, unsigned int flags) struct unix_stream_read_state state . recv_actor = unix_stream_splice_actor . socket = sock . pipe = pipe . size = size . splice_flags = flags , if ( unlikely ( * ppos ) )  if ( sock -> file -> f_flags & O_NONBLOCK || flags & SPLICE_F_NONBLOCK )  state . flags = MSG_DONTWAIT; return unix_stream_read_generic ( & state ) ; static int unix_stream_read_generic(struct unix_stream_read_state *state) struct scm_cookie scm ; struct socket * sock = state -> socket ; struct sock * sk = sock -> sk ; int flags = state -> flags ; if ( sk -> sk_state != TCP_ESTABLISHED )  if ( flags & MSG_OOB )  memset ( & scm , 0 , sizeof ( scm ) ); if ( ! unix_skb_scm_eq ( skb , & scm ) )  scm_set_cred ( & scm , UNIXCB ( skb ) . pid , UNIXCB ( skb ) . uid , UNIXCB ( skb ) . gid ); unix_set_secdata ( & scm , skb ); unix_detach_fds ( & scm , skb ); if ( scm . fp )  scm . fp = scm_fp_dup ( UNIXCB ( skb ) . fp ); scm_recv ( sock , state -> msg , & scm , flags ); scm_destroy ( & scm ); 