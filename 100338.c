static cupsd_job_t *			/* O - Job object CVE_2015_1158_PATCHED_add_job(cupsd_client_t  *con,		/* I - Client connection cupsd_printer_t *printer,	/* I - Destination printer mime_type_t     *filetype)	/* I - First print file type, if any */ http_status_t status ; ipp_attribute_t * attr , * auth_info ; const char * mandatory ; int i ; static const char * const readonly [ ] = if ( ! printer -> shared && _cups_strcasecmp ( con -> http -> hostname , "localhost" ) && _cups_strcasecmp ( con -> http -> hostname , ServerName ) )  auth_info = ippFindAttribute ( con -> request , "auth-info" , IPP_TAG_TEXT ); if ( ( status = cupsdCheckPolicy ( printer -> op_policy_ptr , con , NULL ) ) != HTTP_OK )  if ( printer -> num_auth_info_required == 1 && ! strcmp ( printer -> auth_info_required [ 0 ] , "negotiate" ) && ! con -> username [ 0 ] )  if ( auth_info && ! con -> http -> tls && ! httpAddrLocalhost ( con -> http -> hostaddr ) )  if ( ! printer -> accepting )  for (i = 0; i < (int)(sizeof(readonly) / sizeof(readonly[0])); i ++) if ( ( attr = ippFindAttribute ( con -> request , readonly [ i ] , IPP_TAG_ZERO ) ) != NULL )  if ( StrictConformance )  if ( printer -> pc )  for (mandatory = (char  mandatory = (char *)cupsArrayNext(printer->pc->mandatory)) if ( ! ippFindAttribute ( con -> request , mandatory , IPP_TAG_ZERO ) )  if ( filetype && printer -> filetypes && ! cupsArrayFind ( printer -> filetypes , filetype ) )  if ( ( attr = ippFindAttribute ( con -> request , "copies" , IPP_TAG_INTEGER ) ) != NULL )  if ( attr -> values [ 0 ] . integer < 1 || attr -> values [ 0 ] . integer > MaxCopies )  if ( ( attr = ippFindAttribute ( con -> request , "job-sheets" , IPP_TAG_ZERO ) ) != NULL )  if ( attr -> value_tag != IPP_TAG_KEYWORD && attr -> value_tag != IPP_TAG_NAME )  if ( attr -> num_values > 2 )  for (i = 0; i < attr->num_values; i ++) if ( strcmp ( attr -> values [ i ] . string . text , "none" ) && ! cupsdFindBanner ( attr -> values [ i ] . string . text ) )  