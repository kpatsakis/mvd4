void *fw_cfg_modify_file(FWCfgState *s, const char void *data, size_t len) int i , index ; index = be32_to_cpu ( s -> files -> count ); for (i = 0; i < index; i++) if ( strcmp ( filename , s -> files -> f [ i ] . name ) == 0 )  fw_cfg_add_file_callback ( s , filename , NULL , NULL , data , len ); void fw_cfg_add_file_callback(FWCfgState *s,  const char FWCfgReadCallback callback, void void *data, size_t len) size_t dsize ; if ( ! s -> files )  dsize = sizeof ( uint32_t ) + sizeof ( FWCfgFile ) * FW_CFG_FILE_SLOTS; s -> files = g_malloc0 ( dsize ); fw_cfg_add_bytes ( s , FW_CFG_FILE_DIR , s -> files , dsize ); void fw_cfg_add_bytes(FWCfgState *s, uint16_t key, void *data, size_t len) fw_cfg_add_bytes_read_callback ( s , key , NULL , NULL , data , len ); static void fw_cfg_add_bytes_read_callback(FWCfgState *s, uint16_t FWCfgReadCallback void void *data, size_t len) key &= FW_CFG_ENTRY_MASK; assert ( key < FW_CFG_MAX_ENTRY && len < UINT32_MAX ); 