int CVE_2012_1184_PATCHED_ast_parse_digest(const char *digest, struct ast_http_digest *d, int request, int pedantic) char * c ; struct ast_str * str = ast_str_create ( 16 ) ; if ( ast_strlen_zero ( digest ) || ! d || ! str )  c = ast_skip_blanks ( ast_str_buffer ( str ) ); if ( strncasecmp ( c , "Digest " , strlen ( "Digest " ) ) )  c += strlen ( "Digest " ); while ( c && * c && * ( c = ast_skip_blanks ( c ) ) )  if ( strncasecmp ( c , i -> key , strlen ( i -> key ) ) != 0 )  c += strlen ( i -> key ); if ( * c == '"' )  src = ++ c; src = c; strsep ( & c , separator ); ast_unescape_c ( src ); ast_string_field_ptr_set ( d , i -> field , src ); if ( strcasecmp ( src , "MD5" ) )  ast_log ( LOG_WARNING , "Digest algorithm: \"%s\" not supported.\n" , src ); if ( ! strcasecmp ( i -> key , "qop=" ) && ! strcasecmp ( src , "auth" ) )  if ( sscanf ( src , "%30lx" , & u ) != 1 )  ast_log ( LOG_WARNING , "Incorrect Digest nc value: \"%s\".\n" , src ); ast_string_field_set ( d , nc , src ); 