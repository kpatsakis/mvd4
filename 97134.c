static void unix_destruct_scm(struct sk_buff *skb) struct scm_cookie scm ; memset ( & scm , 0 , sizeof ( scm ) ); scm . pid = UNIXCB ( skb ) . pid; unix_detach_fds ( & scm , skb ); static void unix_detach_fds(struct scm_cookie *scm, struct sk_buff *skb) scm -> fp = UNIXCB ( skb ) . fp; UNIXCB ( skb ) . fp = NULL; for (i = scm->fp->count-1; i >= 0; i--) unix_notinflight ( scm -> fp -> fp [ i ] ); scm_destroy ( & scm ); 