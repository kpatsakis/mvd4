static int CVE_2011_1147_PATCHED_udptl_rx_packet(struct ast_udptl *s, uint8_t *buf, int len) memset ( & s -> f [ 0 ] , 0 , sizeof ( s -> f [ 0 ] ) ); if ( seq_no > s -> rx_seq_no )  if ( seq_no - i >= s -> rx_seq_no )  s -> f [ ifp_no ] . frametype = AST_FRAME_MODEM; s -> f [ ifp_no ] . subclass = AST_MODEM_T38; s -> f [ ifp_no ] . mallocd = 0; s -> f [ ifp_no ] . seqno = seq_no - i; s -> f [ ifp_no ] . datalen = lengths [ i - 1 ]; s -> f [ ifp_no ] . data = ( uint8_t * ) bufs [ i - 1 ]; s -> f [ ifp_no ] . offset = 0; s -> f [ ifp_no ] . src = "UDPTL"; if ( ifp_no > 0 )  AST_LIST_NEXT ( & s -> f [ ifp_no - 1 ] , frame_list ) = & s -> f [ ifp_no ]; AST_LIST_NEXT ( & s -> f [ ifp_no ] , frame_list ) = NULL; ifp_no ++; s -> f [ ifp_no ] . frametype = AST_FRAME_MODEM; s -> f [ ifp_no ] . subclass = AST_MODEM_T38; s -> f [ ifp_no ] . mallocd = 0; s -> f [ ifp_no ] . seqno = seq_no; s -> f [ ifp_no ] . datalen = ifp_len; s -> f [ ifp_no ] . data = ( uint8_t * ) ifp; s -> f [ ifp_no ] . offset = 0; s -> f [ ifp_no ] . src = "UDPTL"; if ( ifp_no > 0 )  AST_LIST_NEXT ( & s -> f [ ifp_no - 1 ] , frame_list ) = & s -> f [ ifp_no ]; AST_LIST_NEXT ( & s -> f [ ifp_no ] , frame_list ) = NULL; ifp_no ++; s -> rx_seq_no = seq_no + 1; return ifp_no ; 