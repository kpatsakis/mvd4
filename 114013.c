static gboolean logcat_read(wtap *wth, int *err, gchar gint64 *data_offset) return logcat_read_packet ( ( struct logcat_phdr * ) wth -> priv , wth -> fh , & wth -> phdr , wth -> frame_buffer , err , err_info ) ; static gboolean logcat_read_packet(struct logcat_phdr *logcat, FILE_T struct wtap_pkthdr *phdr, Buffer *buf, int *err, gchar **err_info) gint bytes_read ; guint tmp [ 2 ] ; guint8 * pd ; bytes_read = file_read ( & tmp , 2 , fh ); if ( bytes_read != 2 )  if ( logcat -> version == 1 )  if ( logcat -> version == 2 )  pd = buffer_start_ptr ( buf ); memcpy ( pd , tmp , 2 ); bytes_read = file_read ( pd + 2 , packet_size - 2 , fh ); if ( bytes_read != packet_size - 2 )  