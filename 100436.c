CVE_2013_0797_VULN_AutoLoadSystemDependencies() static LPCWSTR delayDLLs [ ] = L "wsock32.dll" , L WCHAR systemDirectory [ MAX_PATH + 1 ] = L '\0' size_t systemDirLen = wcslen ( systemDirectory ) ; if ( systemDirectory [ systemDirLen - 1 ] != L '\\' && systemDirLen systemDirectory [ systemDirLen ] = L '\\' for (size_t i = 0; i < sizeof(delayDLLs) / sizeof(delayDLLs[0]); ++i) wcsncpy ( systemDirectory + systemDirLen , delayDLLs [ i ] , MAX_PATH - systemDirLen ); LPCWSTR fullModulePath = systemDirectory ; LoadLibraryW ( fullModulePath ); 