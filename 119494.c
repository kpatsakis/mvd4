static long CVE_2006_2448_PATCHED_restore_sigcontext(struct pt_regs *regs, sigset_t *set, int struct sigcontext __user *sc) elf_vrreg_t __user * v_regs ; unsigned long err = 0 ; elf_greg_t * gregs = ( elf_greg_t * ) regs ; unsigned long msr ; int i ; err |= __copy_from_user ( regs , & sc -> gp_regs , PT_MSR * sizeof ( unsigned long ) ); for (i = PT_MSR+1; i <= PT_RESULT; i++) if ( i == PT_SOFTE )  err |= __get_user ( gregs [ i ] , & sc -> gp_regs [ i ] ); if ( set != NULL )  err |= __get_user ( set -> sig [ 0 ] , & sc -> oldmask ); err |= __copy_from_user ( & current -> thread . fpr , & sc -> fp_regs , FP_REGS_SIZE ); err |= __get_user ( v_regs , & sc -> v_regs ); err |= __get_user ( msr , & sc -> gp_regs [ PT_MSR ] ); if ( err )  if ( v_regs && ! access_ok ( VERIFY_READ , v_regs , 34 * sizeof ( vector128 ) ) )  if ( v_regs != 0 && ( msr & MSR_VEC ) != 0 )  if ( current -> thread . used_vr )  memset ( current -> thread . vr , 0 , 33 * sizeof ( vector128 ) ); err |= __get_user ( current -> thread . vrsave , ( u32 __user * ) & v_regs [ 33 ] ); current -> thread . vrsave = 0; return err ; 