static int CVE_2013_4264_PATCHED_kempf_decode_tile(G2MContext *c, int tile_x, int const uint8_t *src, int src_size) int width , height ; int i , j ; uint8_t pal [ 768 ] , transp [ 3 ] ; int sub_type ; uint8_t * dst = c -> framebuf + tile_x * c -> tile_width * 3 + tile_y * c -> tile_height * c -> framebuf_stride ; if ( src_size < 2 )  width = FFMIN ( c -> width - tile_x * c -> tile_width , c -> tile_width ); height = FFMIN ( c -> height - tile_y * c -> tile_height , c -> tile_height ); hdr = * src ++; sub_type = hdr >> 5; if ( sub_type == 0 )  int j ; memcpy ( transp , src , 3 ); for (j = 0; j < height; j++, dst += c->framebuf_stride) for (i = 0; i < width; i++) memcpy ( dst + i * 3 , transp , 3 ); 