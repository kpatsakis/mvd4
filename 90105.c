void scsi_device_purge_requests(SCSIDevice *sdev, SCSISense sense) SCSIRequest * req ; while ( ! QTAILQ_EMPTY ( & sdev -> requests ) )  req = QTAILQ_FIRST ( & sdev -> requests ); scsi_req_cancel ( req ); void scsi_req_cancel(SCSIRequest *req) if ( ! req -> enqueued )  scsi_req_dequeue ( req ); static void scsi_req_dequeue(SCSIRequest *req) req -> retry = false; if ( req -> enqueued )  req -> enqueued = false; scsi_req_unref ( req ); void scsi_req_unref(SCSIRequest *req) assert ( req -> refcount > 0 ); 