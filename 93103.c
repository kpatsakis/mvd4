void qcms_data_create_rgb_with_gamma(qcms_CIE_xyY white_point, qcms_CIE_xyYTRIPLE primaries, float gamma, void **mem, size_t *size) uint32_t length , offset , index , xyz_count , trc_count ; void * data ; struct matrix colorants ; if ( ( mem == NULL ) || ( size == NULL ) )  xyz_count = 3; trc_count = 3; length = ICC_PROFILE_HEADER_LENGTH + 4 + ( 12 * ( xyz_count + trc_count ) ) + ( xyz_count * 20 ) + ( trc_count * 16 ); data = malloc ( length ); if ( ! data )  memset ( data , 0 , length ); if ( ! get_rgb_colorants ( & colorants , white_point , primaries ) )  free ( data ); 