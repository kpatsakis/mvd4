static CVE_2012_6061_PATCHED_dissect_wtp_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree) int offCur = 0 ; unsigned char b0 ; proto_tree * wtp_tree = NULL ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 == 0 )  if ( tree )  ti = proto_tree_add_item ( tree , proto_wtp , tvb , offCur , 1 , ENC_NA ); wtp_tree = proto_item_add_subtree ( ti , ett_wtp_sub_pdu_tree ); offCur = 1; while ( offCur < ( int ) tvb_reported_length ( tvb ) )  tvbuff_t * wtp_tvb ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 & 0x80 )  c_fieldlen = 2; c_pdulen = ( ( b0 & 0x7f ) << 8 ) | tvb_get_guint8 ( tvb , offCur + 1 ); c_fieldlen = 1; c_pdulen = b0; wtp_tvb = tvb_new_subset ( tvb , offCur + c_fieldlen , c_pdulen , c_pdulen ); CVE_2012_6061_PATCHED_dissect_wtp_common ( wtp_tvb , pinfo , wtp_tree ); offCur += c_fieldlen + c_pdulen; static CVE_2012_6061_PATCHED_dissect_wtp_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree) int offCur = 0 ; unsigned char b0 ; proto_tree * wtp_tree = NULL ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 == 0 )  if ( tree )  ti = proto_tree_add_item ( tree , proto_wtp , tvb , offCur , 1 , ENC_NA ); wtp_tree = proto_item_add_subtree ( ti , ett_wtp_sub_pdu_tree ); offCur = 1; while ( offCur < ( int ) tvb_reported_length ( tvb ) )  tvbuff_t * wtp_tvb ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 & 0x80 )  c_fieldlen = 2; c_pdulen = ( ( b0 & 0x7f ) << 8 ) | tvb_get_guint8 ( tvb , offCur + 1 ); c_fieldlen = 1; c_pdulen = b0; wtp_tvb = tvb_new_subset ( tvb , offCur + c_fieldlen , c_pdulen , c_pdulen ); CVE_2012_6061_PATCHED_dissect_wtp_common ( wtp_tvb , pinfo , wtp_tree ); offCur += c_fieldlen + c_pdulen; static CVE_2012_6061_PATCHED_dissect_wtp_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree) int offCur = 0 ; unsigned char b0 ; proto_tree * wtp_tree = NULL ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 == 0 )  if ( tree )  ti = proto_tree_add_item ( tree , proto_wtp , tvb , offCur , 1 , ENC_NA ); wtp_tree = proto_item_add_subtree ( ti , ett_wtp_sub_pdu_tree ); offCur = 1; while ( offCur < ( int ) tvb_reported_length ( tvb ) )  tvbuff_t * wtp_tvb ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 & 0x80 )  c_fieldlen = 2; c_pdulen = ( ( b0 & 0x7f ) << 8 ) | tvb_get_guint8 ( tvb , offCur + 1 ); c_fieldlen = 1; c_pdulen = b0; wtp_tvb = tvb_new_subset ( tvb , offCur + c_fieldlen , c_pdulen , c_pdulen ); CVE_2012_6061_PATCHED_dissect_wtp_common ( wtp_tvb , pinfo , wtp_tree ); offCur += c_fieldlen + c_pdulen; static CVE_2012_6061_PATCHED_dissect_wtp_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree) int offCur = 0 ; unsigned char b0 ; b0 = tvb_get_guint8 ( tvb , offCur + 0 ); if ( b0 == 0 )  if ( tree )  fprintf ( stderr , "dissect_wtp: (4) tree was %p\n" , tree ); fprintf ( stderr , "dissect_wtp: cbHeader = %d\n" , cbHeader ); 