static ssize_t CVE_2013_6378_PATCHED_lbs_debugfs_write(struct file *f, const char __user size_t cnt, loff_t *ppos) int r , i ; char * pdata ; char * p ; char * p0 ; char * p1 ; struct debug_data * d = f -> private_data ; if ( cnt == 0 )  pdata = kmalloc ( cnt + 1 , GFP_KERNEL ); if ( pdata == NULL )  if ( copy_from_user ( pdata , buf , cnt ) )  pdata [ cnt ] = '\0'; p0 = pdata; for (i = 0; i < num_of_items; i++) p = strstr ( p0 , d [ i ] . name ); if ( p == NULL )  p1 = strchr ( p , '\n' ); if ( p1 == NULL )  p0 = p1 ++; p2 = strchr ( p , '=' ); if ( ! p2 )  p2 ++; r = simple_strtoul ( p2 , NULL , 0 ); * ( ( u8 * ) d [ i ] . addr ) = ( u8 ) r; * ( ( u16 * ) d [ i ] . addr ) = ( u16 ) r; * ( ( u32 * ) d [ i ] . addr ) = ( u32 ) r; * ( ( u64 * ) d [ i ] . addr ) = ( u64 ) r; while ( 1 )  